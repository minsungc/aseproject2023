{"author":"erikmd","number":899,"diff_summary":[{"file":"Dockerfile","status":"M","additions":27,"deletions":17},{"file":"Dockerfile.make","status":"M","additions":27,"deletions":17}],"state":"merged","open_date":"2022-06-16T11:05:12Z","update_date":"2022-06-16T17:11:24Z","discussion":[{"author":"erikmd","date":"2022-06-16T15:50:12Z","comment":"Except `Nix CI for bundle coq-8.14 / category-theory (pull_request_target)`, all checks are green, including Docker-based GitLab CI jobs so I guess this can be merged now :heavy_check_mark: "}],"review_discussion":[{"author":"proux01","file":"Dockerfile","date":"2022-06-16T11:40:40Z","comment":"?"},{"author":"erikmd","file":"Dockerfile","date":"2022-06-16T12:09:01Z","comment":"To give more insight, `RUN` admits two syntaxes:\r\n\r\n* the **shell form**:  \r\n  `RUN cmd1 && cmd2`  \r\n  (which uses `/bin/sh -c` as implicit shell, or `/bin/bash --login … -c` thanks to the previous `SHELL` command)\r\n\r\n* the **exec form**:  \r\n  `RUN [\"prog\", \"arg1\", \"…\"]`  \r\n  which is more \"precise\" because we can specify the shell in an explicit way, but is very rarely used in practice because it's heavier.\r\n\r\nSo this patch is just a convenience refactoring that amounts to removing one level of brackets/quoting.\r\n\r\nRegarding # hadolint ignore, it's just a Dockerfile linter annotation I had added when preparing the Dockerfiles for stable versions of math-comp.\r\n\r\nI've just run it again (`docker run --rm -i hadolint/hadolint < Dockerfile`) and it spotted more details; will force-push another commit."}],"tags":[{"tag":"kind: CI","description":"Issue or PR about the CI. (Gitlab CI or CI of dependencies problems linked with math-comp)"}],"commits":[{"author":"erikmd","committer":"erikmd","hash":"035acb1c21d364f8fe32946e59caacc427abf051","message":"refactor(Dockerfile): no need for multi-stage build anymore\n\n* Remove `FROM coqorg/base:bare` as all `coqorg/coq:*` are mono-switch\n* This should speedup mathcomp's CI and increase Docker layers sharing","date":"2022-06-16T11:04:21Z"},{"author":"erikmd","committer":"erikmd","hash":"ace7eb71f737661df9913bb07163d174ccce3be7","message":"refactor(Dockerfile): minor tweaks","date":"2022-06-16T12:00:43Z"}]}