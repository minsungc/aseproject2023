{"author":"CohenCyril","number":706,"diff_summary":[{"file":"mathcomp/field/closed_field.v","status":"M","additions":41,"deletions":41},{"file":"mathcomp/ssreflect/eqtype.v","status":"M","additions":41,"deletions":41},{"file":"mathcomp/ssreflect/finfun.v","status":"M","additions":41,"deletions":41},{"file":"mathcomp/ssreflect/fintype.v","status":"M","additions":41,"deletions":41},{"file":"mathcomp/ssreflect/seq.v","status":"M","additions":41,"deletions":41},{"file":"mathcomp/ssreflect/ssrbool.v","status":"M","additions":41,"deletions":41}],"state":"closed","open_date":"2021-03-04T20:51:34Z","update_date":"2022-06-08T07:46:32Z","discussion":[{"author":"CohenCyril","date":"2021-03-04T21:01:59Z","comment":"@erikmd the CI does not show-up anymore on mathcomp PR, do you understand why?"},{"author":"erikmd","date":"2021-03-04T21:22:26Z","comment":"Hi @CohenCyril, I first took a look at https://gitlab.com/math-comp/math-comp/-/pipelines\r\nand many pipelines were pending\r\n(which seemed to be related to these prod issues:\r\n- https://gitlab.com/gitlab-com/gl-infra/production/-/issues/3857\r\n- https://gitlab.com/gitlab-com/gl-infra/production/-/issues/3858\r\n\r\n) but, these pipelines just seemed to be started in one go (a couple of seconds ago) whereas the status is still not propagated to the GitHub Check tabs.\r\nI don't have much more clues… but maybe let's wait for the completion of these pipelines, and if there's not GitHub-Checks-feedback at that point, ask Théo to take a look at the coqbot logs?"},{"author":"erikmd","date":"2021-03-05T10:20:48Z","comment":"Hi @Zimmi48,\r\nCyril noticed that since yesterday Thursday, the GitLab pipeline status is not propagated back to GitHub commit nor Checks tab…\r\nwould you have some clue / logs information or so regarding the source of this issue? FTR, the GitLab pipeline that has been successfully triggered by this PR is https://gitlab.com/math-comp/math-comp/-/pipelines/265650597"},{"author":"Zimmi48","date":"2021-03-05T17:42:51Z","comment":"Hi @erikmd, thanks for pinging me. I don't have access to the GitLab webhook logs of the math-comp repository, but I'll look into the server logs to see if I detect anything wrong."},{"author":"Zimmi48","date":"2021-03-05T18:18:07Z","comment":"Unfortunately, my logs do not give me any relevant information and math-comp is the only project that I am aware of that is suffering from this issue right now. It also looks like this is not the first time that this has happened: already a couple of PRs suffered from the same symptoms on Jan 27-28.\r\n\r\nThat being said, math-comp is also the last project that I am aware of that is relying on the legacy installation (see https://github.com/coq/bot/#how-to-use-the-coqbot-instance). So that could be one explanation of why this is behaving differently.\r\n\r\nI'll try to improve my logging as soon as I get the chance. If the problem persists, you may want to give a shot at migrating to the GitHub App to see if this is related. Please let me know if the problem continues or disappears and if you know any other project suffering from it."},{"author":"erikmd","date":"2021-03-05T18:32:43Z","comment":"Hi @Zimmi48, thanks for looking into this!\r\n\r\n> math-comp is also the last project that I am aware of that is relying on the legacy installation \r\n\r\nah OK… I believed we had changed the setup to use coqbot already; so I guess what you suggest (migrating `math-comp/math-comp` to `coqbot`) would be the best fix.\r\n\r\n@CohenCyril could you do that migration?\r\n\r\nIINM, it amounts to:\r\n* Follow the instructions of https://github.com/coq/bot/#as-a-github-app \r\n* Goto https://github.com/math-comp/math-comp/settings/hooks and remove the old webhook to avoid potential duplicates…"},{"author":"CohenCyril","date":"2021-03-05T18:43:16Z","comment":"@erikmd \r\n> @CohenCyril could you do that migration?\r\n\r\nI think I did it at some point when you asked me to... I can't check in details right now, but coqbot is indeed not in the webhooks."},{"author":"Zimmi48","date":"2021-03-05T21:41:20Z","comment":"Ah OK. Sorry for the confusion, I hadn't realized it had already been the case. Then, this is something else. I'll try to investigate more."},{"author":"erikmd","date":"2021-03-07T20:34:51Z","comment":"Hi @Zimmi48, following your comments I just double-checked the page\r\nhttps://gitlab.com/math-comp/math-comp/hooks\r\nand I believe this configuration was incomplete w.r.t. what is currently specified in https://github.com/coq/bot/#as-a-github-app\r\n\r\nFTR, I saw:\r\n![2021-03-07_21-29-37_Screenshot_webhook](https://user-images.githubusercontent.com/10367254/110253761-5bf71300-7f8c-11eb-84cf-ebebf8001edb.png)\r\n\r\nI modified this, and I now see:\r\n![2021-03-07_21-38-27_Screenshot_hooks_latest](https://user-images.githubusercontent.com/10367254/110254003-7d0c3380-7f8d-11eb-848e-f8f10b1616f0.png)\r\n\r\n@CohenCyril I hope the issue you raised is now solved; so let me know if the fix is confirmed (or not…)"},{"author":"Zimmi48","date":"2021-03-08T10:35:42Z","comment":"In principle, the legacy endpoint `/pipeline` is still supported exactly as `/gitlab` but what is more surprising is that it seems Job Events and Pipeline Events were not sent if we can believe the difference of descriptions between the two. I wonder what happened.\r\n\r\nAnyway, this seems to have worked in fixing the status report to GitHub."},{"author":"CohenCyril","date":"2021-03-08T11:35:50Z","comment":"Indeed! The issue is fixed. Thank you so much @erikmd and @Zimmi48 !!"},{"author":"proux01","date":"2022-06-08T07:46:32Z","comment":"This has been fixed by https://github.com/math-comp/math-comp/pull/856"}],"review_discussion":[],"tags":[{"tag":"kind: fix","description":"PR that fixes a bug. Please refer to the appropriate issue(s) if relevant."},{"tag":"kind: warning","description":"Issue or PR about a warning raised by Coq"},{"tag":"drops: coq 8.11","description":""},{"tag":"drops: coq 8.12","description":""}],"commits":[{"author":"CohenCyril","committer":"CohenCyril","hash":"2fdcaeb3e8b4f82a5f1b134b89ebf1ef11ca4081","message":"Switching `ident` -> `name` in notations","date":"2021-03-08T11:34:18Z"}]}