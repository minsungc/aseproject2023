{"author":"yoshihiro503","number":937,"diff_summary":[{"file":"CHANGELOG_UNRELEASED.md","status":"M","additions":44,"deletions":0},{"file":"mathcomp/algebra/matrix.v","status":"M","additions":44,"deletions":0}],"state":"merged","open_date":"2022-10-21T02:27:35Z","update_date":"2022-11-20T22:11:24Z","discussion":[{"author":"proux01","date":"2022-10-23T16:29:57Z","comment":"According to WP: https://en.wikipedia.org/wiki/Vandermonde_matrix the Vandermonde matrix seems to be the transpose, but they also say \"Some authors define the Vandermonde matrix as the [transpose](https://en.wikipedia.org/wiki/Transpose) of the above matrix\". I don't know which one we want here?"},{"author":"CohenCyril","date":"2022-10-24T00:33:09Z","comment":"> According to WP: https://en.wikipedia.org/wiki/Vandermonde_matrix the Vandermonde matrix seems to be the transpose, but they also say \"Some authors define the Vandermonde matrix as the [transpose](https://en.wikipedia.org/wiki/Transpose) of the above matrix\". I don't know which one we want here?\r\n\r\nWe do want the transpose of the \"normal one\" (i.e. the one that is defined here) due to the specific conventions of the mathcomp library wrt that."},{"author":"proux01","date":"2022-10-24T08:05:40Z","comment":"I don't get those specific conventions but I definitely trust you."},{"author":"CohenCyril","date":"2022-10-27T12:04:29Z","comment":"@yoshihiro503 @affeldt-aist also `Vandermonde` must be added to the header of the file (I chose to capitalize and keep the name full because it's a proper name).\r\nPS: is it clear how to proceed to get this PR merged?"},{"author":"CohenCyril","date":"2022-11-21T15:12:54Z","comment":"Thank you @yoshihiro503 "}],"review_discussion":[{"author":"CohenCyril","file":"mathcomp/algebra/matrix.v","date":"2022-10-21T16:59:39Z","comment":"I suggest the following proof instead.\r\n```suggestion\r\n\r\nDefinition Vandermonde (R : ringType) (m n : nat) (a : 'rV[R]_n) :=\r\n  \\matrix_(i < m, j < n) a 0 j ^+ i.\r\n\r\nLemma det_Vandermonde (R : comRingType) (n : nat) (a : 'rV[R]_n) :\r\n  \\det (Vandermonde n a) = \\prod_(i < n) \\prod_(j < n | i < j) (a 0 j - a 0 i).\r\nProof.\r\nset V := @Vandermonde R.\r\nelim: n => [|n IHn] in a *; first by rewrite det_mx00 big1// => -[] [].\r\npose b : 'rV_n := \\row_i a 0 (lift 0 i).\r\npose C : 'M_n := diag_mx (\\row_(i < n) (b 0 i - a 0 0)).\r\npose D : 'M_n.+1 := 1 - a 0 0 *: \\matrix_(i, j) (i == j.+1 :> nat)%:R. \r\nhave detD : \\det D = 1.\r\n  rewrite det_trig ?big_ord_recl ?mxE ?mulr0 ?subr0 ?eqxx.\r\n    by rewrite ?big1 ?mulr1// => i; rewrite !mxE eqxx ltn_eqF// mulr0 subr0.\r\n  by apply/is_trig_mxP => *; rewrite !mxE ![_ == _]ltn_eqF ?mulr0 ?subr0 ?leqW.\r\nsuff: D * V _ _ a = block_mx 1 (const_mx 1) 0 (V _ _ b *m C) :> 'M_(1 + n).\r\n  move=> /(congr1 determinant); rewrite detM detD mul1r => ->.\r\n  rewrite det_ublock det1 mul1r det_mulmx IHn big_ord_recl mulrC; congr (_ * _).\r\n    rewrite big_mkcond big_ord_recl/= mul1r det_diag.\r\n    by under eq_bigr do rewrite !mxE.\r\n  apply: eq_bigr => i _; under eq_bigr do rewrite !mxE.\r\n  by rewrite big_mkcond [RHS]big_mkcond big_ord_recl/= mul1r.\r\nrewrite mulrBl mul1r -scalerAl; apply/matrixP => i j; rewrite !mxE.\r\nunder eq_bigr do rewrite !mxE; case: splitP => [{i}_ -> /[!ord1]|{}i ->].\r\n  rewrite !expr0 big1; last by move=> ?; rewrite mul0r.\r\n  by rewrite ?mulr0 ?subr0 ?mxE; case: splitP => k; rewrite ?ord1 mxE//.\r\nunder eq_bigr do rewrite eqSS mulr_natl mulrb eq_sym.\r\nrewrite -big_mkcond/= big_ord1_eq exprS ifT// ?leqW// -mulrBl !mxE/=.\r\ncase: split_ordP => [{j}_ -> /[!ord1]|{}j ->]; rewrite ?lshift0 ?rshift1 ?mxE.\r\n   by rewrite ?subrr ?mul0r//.\r\nunder eq_bigr do rewrite !mxE mulrnAr mulrb.\r\nby rewrite -big_mkcond big_pred1_eq /= mulrC.\r\nQed.\r\n```\r\nWas there a particular reason why the dimensions were not the same?"},{"author":"CohenCyril","file":"mathcomp/algebra/matrix.v","date":"2022-10-24T16:15:34Z","comment":"> Was there a particular reason why the dimensions were not the same?\r\n\r\n@affeldt-aist ?"},{"author":"affeldt-aist","file":"mathcomp/algebra/matrix.v","date":"2022-10-25T00:01:19Z","comment":"It looks like infotheo is using a non-square version of the Vandermonde matrix to define generalized Reed-Solomon codes but I do not have the reference material at hand right now."},{"author":"CohenCyril","file":"mathcomp/algebra/matrix.v","date":"2022-10-26T00:27:49Z","comment":"I restored the non-square definition"},{"author":"CohenCyril","file":"CHANGELOG_UNRELEASED.md","date":"2022-10-28T16:22:52Z","comment":"```suggestion\r\n  + definition `Vandermonde`\r\n```"},{"author":"CohenCyril","file":"mathcomp/algebra/matrix.v","date":"2022-10-28T17:30:54Z","comment":"```suggestion\r\n(* Vandermonde m a == the 'M[R]_(m, n) Vandermonde matrix, given a : 'rV_n    *)\r\n(*                    /         1          ...           1              \\     *)\r\n(*                    |      (a 0 0)       ...      (a 0 (n - 1))       |     *)\r\n(*                    |    (a 0 0 ^+ 2)    ...    (a 0 (n - 1) ^+ 2)    |     *)\r\n(*                    |        ...                      ...             |     *)\r\n(*                    \\ (a 0 0 ^+ (m - 1)) ... (a 0 (n - 1) ^+ (m - 1)) /     *)\r\n(*                 := \\matrix_(i < m, j < n) a 0 j ^+ i.                      *)\r\n```"},{"author":"yoshihiro503","file":"mathcomp/algebra/matrix.v","date":"2022-11-04T07:34:34Z","comment":"Thank you for the correction.  I have imported the commits and organized the history."},{"author":"CohenCyril","file":"mathcomp/algebra/matrix.v","date":"2022-11-07T14:21:32Z","comment":"It seems that the documentation header went missing ..."},{"author":"yoshihiro503","file":"mathcomp/algebra/matrix.v","date":"2022-11-11T02:34:59Z","comment":"I had erased it by mistake. It is okay now."}],"tags":[],"commits":[{"author":"yoshihiro503","committer":"yoshihiro503","hash":"4f9b09b4272189c32f14bab7a6d5f6e76380e755","message":"vandermode matrix from infotheo project: https://github.com/affeldt-aist/infotheo\n\nCo-authored-by: Reynald Affeldt <reynald.affeldt@aist.go.jp>","date":"2022-11-18T01:28:25Z"},{"author":"yoshihiro503","committer":"yoshihiro503","hash":"7449fdb560aa5bda8cbf4fe91b49a445d9353e7a","message":"Update mathcomp/algebra/matrix.v\n\nCo-authored-by: Cyril Cohen <CohenCyril@users.noreply.github.com>","date":"2022-11-18T01:28:25Z"},{"author":"yoshihiro503","committer":"yoshihiro503","hash":"5a6fcb2169fc08ff9cb5b878da2a7ffb5ebf4930","message":"changelog and Documentation for vandermonde matrix\n\nCo-authored-by: Cyril Cohen <CohenCyril@users.noreply.github.com>","date":"2022-11-18T01:28:25Z"}]}